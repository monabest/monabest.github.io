<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">



<title>
  
    Archive: 2017
  
</title>

<meta property="og:type" content="website">
<meta property="og:title" content="MonaBest-Blogggyyy">
<meta property="og:url" content="http://yoursite.com/archives/2017/index.html">
<meta property="og:site_name" content="MonaBest-Blogggyyy">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="MonaBest-Blogggyyy">


  <link rel="alternative" href="/atom.xml" title="MonaBest-Blogggyyy" type="application/atom+xml">



  <link rel="icon" href="/favicon.png">


<link rel="stylesheet" href="/styles/main.css">






</head>
<body
  
    class="monochrome"
  
  >
  <div class="mobile-header">
  <button class="sidebar-toggle" type="button">
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
  </button>
  <a class="title" href="/">MonaBest-Blogggyyy</a>
</div>

  <div class="main-container">
    <div class="sidebar">
  <div class="header">
    <h1 class="title"><a href="/">MonaBest-Blogggyyy</a></h1>
    
    <div class="info">
      <div class="content">
        
        
          <div class="author">Mona Qiu</div>
        
      </div>
      
        <div class="avatar">
          
            <a href="monabest.git.io"><img src="http://scontent.cdninstagram.com/t51.2885-15/s480x480/e35/11351794_1500041536990504_88089302_n.jpg?ig_cache_key=MTExNzUzMjQyNDAxMDY4MDcyNg%3D%3D.2"></a>
          
        </div>
      
    </div>
  </div>
  <div class="body">
    
      
        <ul class="nav">
          
            
              <li class="category-list-container">
                <a href="javascript:;">Category</a>
                
              </li>
            
          
            
              <li class="tag-list-container">
                <a href="javascript:;">Tag</a>
                <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java-Programming/">Java Programming</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/System-Design/">System Design</a><span class="tag-list-count">1</span></li></ul>
              </li>
            
          
            
              <li class="archive-list-container">
                <a href="javascript:;">Archive</a>
                <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/">2017</a><span class="archive-list-count">4</span></li></ul>
              </li>
            
          
        </ul>
      
        <ul class="nav">
          
            
              <li>
                <a href="/" title="Homepage">Homepage</a>
              </li>
            
          
            
              <li>
                <a href="/archives" title="By Year">By Year</a>
              </li>
            
          
        </ul>
      
        <ul class="nav">
          
            
              <li>
                <a href="https://github.com/monabest" title="Github" target="_blank" rel="external">Github</a>
              </li>
            
          
        </ul>
      
    
  </div>
</div>

    <div class="main-content">
      
        <div style="max-width: 2300px">
      
          

  
  
    
      
      
      <section class="archives-wrap">
        <div class="archive-year-wrap">
          <h1><a href="/archives/2017" class="archive-year">2017</a></h1>
        </div>
        <div class="post-list">
    
  

    <div class="post-list-item article">
      <h3 class="article-header">
        <a href="/2017/02/13/What-happends-when-you-nevigate-to-a-URL/" >
  What happends when you nevigate to a URL
</a>

      </h3>
      

      <div class="article-info">
        <a href="/2017/02/13/What-happends-when-you-nevigate-to-a-URL/"><span class="article-date">
  2017-02-13
</span>
</a>
        

        
	<span class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/System-Design/">System Design</a></li></ul>
	</span>


      </div>
      <div class="article-entry">
        
          <h3 id="what-happens-when-you-nevigate-to-a-URL"><a href="#what-happens-when-you-nevigate-to-a-URL" class="headerlink" title="what happens when you nevigate to a URL"></a>what happens when you nevigate to a URL</h3><h4 id="1-enter-a-URL-into-the-browser"><a href="#1-enter-a-URL-into-the-browser" class="headerlink" title="1. enter a URL into the browser"></a>1. enter a URL into the browser</h4><h4 id="2-browser-looks-up-the-IP-address-for-the-domain-name"><a href="#2-browser-looks-up-the-IP-address-for-the-domain-name" class="headerlink" title="2. browser looks up the IP address for the domain name"></a>2. browser looks up the IP address for the domain name</h4><blockquote>
<ul>
<li>The browser caches DNS records for some time. </li>
<li>OS cache, if the browser cache does not contain the desired record, the browser makes a system call. Os has its own cache.</li>
<li>Router cache</li>
<li>IPS DNS cache</li>
<li>Recursive search</li>
</ul>
</blockquote>
<h4 id="3-The-browser-send-a-HTTP-to-the-web-server"><a href="#3-The-browser-send-a-HTTP-to-the-web-server" class="headerlink" title="3. The browser send a HTTP to the web server."></a>3. The browser send a HTTP to the web server.</h4><p>  Be sure that FB’s homepage will not be served from the browser cache because dynamic pages expire either every quickly or immediately</p>
<blockquote>
<p>GET <a href="http://facebook.com/" target="_blank" rel="external">http://facebook.com/</a> HTTP/1.1 Accept:<br>application/x-ms-application, image/jpeg, application/xaml+xml, […]<br>User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64;<br>[…] Accept-Encoding: gzip, deflate Connection: Keep-Alive Host:<br>facebook.com Cookie: datr=1265876274-[…]; locale=en_US; lsd=WW[…];<br>c_user=2101[…]</p>
</blockquote>
<p>GET request names the URL to fetch “<a href="http://facebook.com/" target="_blank" rel="external">http://facebook.com/</a>“. The brower identifies itself(User Agent header), and states what types of responses it will accept(Accept and Accept- Encoding headers). The connection header asks the server to keep the TCP connection open for further requests.<br>The request also contains the cookies that the browser has for this domain. As you probably already know, cookies are key-value pairs that track the state of a web site in between different page requests. And so the cookies store the name of the logged-in user, a secret number that was assigned to the user by the server, some of user’s settings, etc. The cookies will be stored in a text file on the client, and sent to the server with every request.</p>
<blockquote>
<p>In addition to GET requests, another type of requests that you may be<br>familiar with is a POST request, typically used to submit forms. A GET<br>request sends its parameters via the URL (e.g.:<br><a href="http://robozzle.com/puzzle.aspx?id=85" target="_blank" rel="external">http://robozzle.com/puzzle.aspx?id=85</a>). A POST request sends its<br>parameters in the request body, just under the headers.</p>
</blockquote>
<p>.</p>
<blockquote>
<p>The trailing slash in the URL “<a href="http://facebook.com/”" target="_blank" rel="external">http://facebook.com/”</a> is important. In<br>this case, the browser can safely add the slash. For URLs of the form<br><a href="http://example.com/folderOrFile" target="_blank" rel="external">http://example.com/folderOrFile</a>, the browser cannot automatically add<br>a slash, because it is not clear whether folderOrFile is a folder or a<br>file. In such cases, the browser will visit the URL without the slash,<br>and the server will respond with a redirect, resulting in an<br>unnecessary roundtrip.</p>
</blockquote>
<h4 id="4-The-facebook-server-responds-with-a-permanent-redirect"><a href="#4-The-facebook-server-responds-with-a-permanent-redirect" class="headerlink" title="4. The facebook server responds with a permanent redirect"></a>4. The facebook server responds with a permanent redirect</h4><blockquote>
<p>HTTP/1.1 301 Moved Permanently Cache-Control: private, no-store,<br>no-cache, must-revalidate, post-check=0,<br>      pre-check=0 Expires: Sat, 01 Jan 2000 00:00:00 GMT Location: <a href="http://www.facebook.com/" target="_blank" rel="external">http://www.facebook.com/</a> P3P: CP=”DSP LAW” Pragma: no-cache<br>Set-Cookie: made_write_conn=deleted; expires=Thu, 12-Feb-2009 05:09:50<br>GMT;<br>      path=/; domain=.facebook.com; httponly Content-Type: text/html; charset=utf-8 X-Cnection: close Date: Fri, 12 Feb 2010 05:09:51 GMT<br>Content-Length: 0</p>
</blockquote>
<p>Tell browser to redirect.<br>Reasons: 1. search engine rankings 2. multiple URLs for the same content are not cache- friendly. </p>
<p>####5. The browser follows the redirect<br>The browser now knows the correct URL and sends out another GET request</p>
<h4 id="6-The-server-handles-the-request"><a href="#6-The-server-handles-the-request" class="headerlink" title="6. The server handles the request"></a>6. The server handles the request</h4><p>web server software<br>request handler heandler</p>
<h4 id="7-The-server-sends-back-a-HTMP-response"><a href="#7-The-server-sends-back-a-HTMP-response" class="headerlink" title="7. The server sends back a HTMP response"></a>7. The server sends back a HTMP response</h4><h4 id="8-The-browser-begins-rendering-the-HTML"><a href="#8-The-browser-begins-rendering-the-HTML" class="headerlink" title="8. The browser begins rendering the HTML"></a>8. The browser begins rendering the HTML</h4><h4 id="9-The-browser-sends-requests-for-objects-embedded-in-HTML"><a href="#9-The-browser-sends-requests-for-objects-embedded-in-HTML" class="headerlink" title="9. The browser sends requests for objects embedded in HTML."></a>9. The browser sends requests for objects embedded in HTML.</h4><p>As the browser renders the HTML, it will notice tags that require fetching of other URLs. The browser will send a GET request to retrieve each of these files.<br>Each of these URLs will go through process a similar to what the HTML page went through. So, the browser will look up the domain name in DNS, send a request to the URL, follow redirects, etc. However, static files – unlike dynamic pages – allow the browser to cache them. Some of the files may be served up from cache, without contacting the server at all. The browser knows how long to cache a particular file because the response that returned the file contained an Expires header. </p>
<h4 id="10-The-browser-sends-further-synchronous-AJAX-requests"><a href="#10-The-browser-sends-further-synchronous-AJAX-requests" class="headerlink" title="10. The browser sends further synchronous(AJAX) requests."></a>10. The browser sends further synchronous(AJAX) requests.</h4><p>In the Facebook example, the client sends a POST request to <a href="http://www.facebook.com/ajax/chat/buddy_list.php" target="_blank" rel="external">http://www.facebook.com/ajax/chat/buddy_list.php</a> to fetch the list of your friends who are online.<br>This pattern is sometimes referred to as “AJAX”, which stands for “Asynchronous JavaScript And XML”</p>
<blockquote>
<p>Facebook chat provides an example of an interesting problem with AJAX:<br>pushing data from server to client. Since HTTP is a request-response<br>protocol, the chat server cannot push new messages to the client.<br>Instead, the client has to poll the server every few seconds to see if<br>any new messages arrived.</p>
</blockquote>
<p>Reference: <a href="http://igoro.com/archive/what-really-happens-when-you-navigate-to-a-url/" target="_blank" rel="external">http://igoro.com/archive/what-really-happens-when-you-navigate-to-a-url/</a></p>

        
      </div>
    </div>

  

  
  
    
  

    <div class="post-list-item article">
      <h3 class="article-header">
        <a href="/2017/02/05/Reading-Effective-Java/" >
  Reading -Effective Java
</a>

      </h3>
      

      <div class="article-info">
        <a href="/2017/02/05/Reading-Effective-Java/"><span class="article-date">
  2017-02-05
</span>
</a>
        

        
	<span class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java-Programming/">Java Programming</a></li></ul>
	</span>


      </div>
      <div class="article-entry">
        
          <h1 id="Effective-Java"><a href="#Effective-Java" class="headerlink" title="Effective Java"></a>Effective Java</h1><h2 id="Chapter-1"><a href="#Chapter-1" class="headerlink" title="Chapter 1"></a>Chapter 1</h2><p>make effective use of  <code>java.util, java.util.concurrent, java.io</code><br>module refers to any reusable software component</p>
<blockquote>
<ul>
<li>Interfaces (including annota- tions), classes (including enums), array are reference types</li>
<li>Primitives are not objects</li>
<li>A method’s signature: 1. its name 2. the types of its formal parameters</li>
<li>Signature does not include the method’s return type.</li>
</ul>
</blockquote>
<p>This book uses  <code>package-private</code> instead of the term  <code>default</code> access.<br>The term <code>exported API</code>, or <code>API</code>, refers to the classes, interfaces, constructors, members, and serialized forms by which a programmer accesses a class, interface, or package.<br>API short for <em>application programming interface</em>.<br>A class whose implementation uses an API is a client of the API.<br>Classes, interfaces, constructors, members, and serialized forms are collec- tively known as API elements.</p>
<h2 id="Chapter-2"><a href="#Chapter-2" class="headerlink" title="Chapter 2"></a>Chapter 2</h2><h3 id="Creating-and-Destroying-Objects"><a href="#Creating-and-Destroying-Objects" class="headerlink" title="Creating and Destroying Objects"></a>Creating and Destroying Objects</h3><h4 id="Item-1-consider-static-factory-methods-instead-of-constructors"><a href="#Item-1-consider-static-factory-methods-instead-of-constructors" class="headerlink" title="Item 1: consider static factory methods instead of constructors"></a>Item 1: consider static factory methods instead of constructors</h4><p>A normal way for a class to provide an instance of itself is to provide a public constructor.<br>Another technique is that a class can provide a <code>public static factory method</code>, which is simply a static method that returns an instance of the class.<br>Advantages:</p>
<blockquote>
<ul>
<li>name easier to read: e.g.BigInteger(int, int, Random), returns a BigInteger that is probably prime, would have been better expressed as a static factory method named BigIn- teger.probablePrime.The Boolean.valueOf(boolean) method illus- trates this technique: it never creates an object. </li>
<li>In cases where a class seems to require multiple constructors with the same signature, replace the constructors with static factory methods and carefully chosen names to highlight their differences.</li>
<li>Static factory methods is unlike constructors. They are not required to create a new object each time they’re invoked. The Boolean.valueOf(boolean) method illustrates this technique: it never creates an object</li>
<li>unlike constructors, they can return an object of any subtype of their return type</li>
<li>static factory methods reduce the verbosity of creating parameterized type instances. e.g. Map<string, list<string="">&gt; m = HashMap.newInstance();</string,></li>
</ul>
</blockquote>
<p>Distanvages:</p>
<blockquote>
<ul>
<li>classes without public or protected constructors cannot be subclassed.</li>
<li>they are not readily distinguishable from other static methods. </li>
</ul>
</blockquote>
<p>Three essential components of a service provider framework:</p>
<ol>
<li>a service interface: provides implement</li>
<li>a provider registration API: systems uses to register implements.</li>
<li>service access API: clients use to obtain an instance of the service.</li>
<li>serice provider interface: provdes implement to create instances of their service implementation.<br>StackOverFlow example:<br>The static factory method pattern is a way to encapsulate object creation. Without a factory method, you would simply call the class’s constructor directly: <code>Foo x = new Foo()</code>. With this pattern, you would instead call the factory method: <code>Foo x = Foo.create()</code> The constructors are marked private, so they cannot be called except from inside the class, and the factory method is marked as static so that it can be called without first having an object.</li>
</ol>
<h4 id="Item-2-consider-a-builder-when-faced-with-many-constructor-parameters"><a href="#Item-2-consider-a-builder-when-faced-with-many-constructor-parameters" class="headerlink" title="Item 2: consider a builder when faced with many constructor parameters"></a>Item 2: consider a builder when faced with many constructor parameters</h4><p>static factories and constructor have limitation: do not handle well with large numbers of optional parameters.<br>Traditionally, use <code>telescoping constructor pattern</code>: You provide a constructor with only required params, another with a single optional param, a thrid with 2 optional params and so on. e.g<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//doesn't scale well, only part of the code.</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">NutritionFacts</span><span class="params">(<span class="keyword">int</span> servingSize, <span class="keyword">int</span> servings)</span> </span>&#123;</div><div class="line">    <span class="keyword">this</span>(servingSize, servings, <span class="number">0</span>);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">NutritionFacts</span><span class="params">(<span class="keyword">int</span> servingSize, <span class="keyword">int</span> servings,</span></span></div><div class="line">        <span class="keyword">int</span> calories) &#123;</div><div class="line">    <span class="keyword">this</span>(servingSize, servings, calories, <span class="number">0</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>A second alternative when you are faced with many constructor parameters is the <code>JavaBeans pattern</code>: call a parameterless constructor to create the object ad call setters. disadvantages: 1. may be in an inconsistent state partway through its construction. 2. precludes the possibility of making a class immutable<br>A third alternative: <code>Builder Pattern</code> combines the safety of the telescoping constructor pattern with the readability of the JavaBeans pattern.<br>Step:</p>
<blockquote>
<ul>
<li>client calls a constructor (or static factory) with all required parameters and gets a builder object.</li>
<li>client calls setter-like methods on the builder object to set each optional parameter of itereset.</li>
<li>client calls a parameterless build method to generate the immutable object.</li>
<li>builder is a static member class of the class it builds.</li>
</ul>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Builder Pattern</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NutritionFacts</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> servingSize;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> servings;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> calories;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> fat;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> sodium;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> carbohydrate;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Builder</span> </span>&#123;</div><div class="line">        <span class="comment">// Required parameters</span></div><div class="line">        <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> servingSize;</div><div class="line">        <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> servings;</div><div class="line">        <span class="comment">// Optional parameters </span></div><div class="line">        <span class="keyword">private</span> <span class="keyword">int</span> calories      = <span class="number">0</span>;</div><div class="line">        <span class="keyword">private</span> <span class="keyword">int</span> fat           = <span class="number">0</span>;</div><div class="line">        <span class="keyword">private</span> <span class="keyword">int</span> carbohydrate  = <span class="number">0</span>;</div><div class="line">        <span class="keyword">private</span> <span class="keyword">int</span> sodium        = <span class="number">0</span>;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Builder</span><span class="params">(<span class="keyword">int</span> servingSize, <span class="keyword">int</span> servings)</span> </span>&#123;</div><div class="line">            <span class="keyword">this</span>.servingSize = servingSize;</div><div class="line">            <span class="keyword">this</span>.servings    = servings;</div><div class="line">    &#125;</div><div class="line">        <span class="function"><span class="keyword">public</span> Builder <span class="title">calories</span><span class="params">(<span class="keyword">int</span> val)</span></span></div><div class="line">            &#123; calories = val;      <span class="keyword">return</span> <span class="keyword">this</span>; &#125;</div><div class="line">        <span class="function"><span class="keyword">public</span> Builder <span class="title">fat</span><span class="params">(<span class="keyword">int</span> val)</span></span></div><div class="line">            &#123; fat = val;           <span class="keyword">return</span> <span class="keyword">this</span>; &#125;</div><div class="line">        <span class="function"><span class="keyword">public</span> Builder <span class="title">carbohydrate</span><span class="params">(<span class="keyword">int</span> val)</span></span></div><div class="line">            &#123; carbohydrate = val;  <span class="keyword">return</span> <span class="keyword">this</span>; &#125;</div><div class="line">        <span class="function"><span class="keyword">public</span> Builder <span class="title">sodium</span><span class="params">(<span class="keyword">int</span> val)</span></span></div><div class="line">            &#123; sodium = val;        <span class="keyword">return</span> <span class="keyword">this</span>; &#125;</div><div class="line">        <span class="function"><span class="keyword">public</span> NutritionFacts <span class="title">build</span><span class="params">()</span> </span>&#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">new</span> NutritionFacts(<span class="keyword">this</span>);</div><div class="line">        &#125; </div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="title">NutritionFacts</span><span class="params">(Builder builder)</span> </span>&#123;</div><div class="line">        servingSize  = builder.servingSize;</div><div class="line">        servings = buider.servings;</div><div class="line">        calories = builder.calories;</div><div class="line">        fat = builder.fat;</div><div class="line">        sodium = builder.sodium;</div><div class="line">        carbohydrate = builder.carbohydrate;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p> NutritionFacts is immutable, and that all parameter default values are in a single location. The builder’s setter methods return the builder itself so that invocations can be chained. Here’s how the client code looks:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">NutritionFacts cocaCola = <span class="keyword">new</span> NutritionFacts.Builder(<span class="number">240</span>, <span class="number">8</span>).calories(<span class="number">100</span>).sodium(<span class="number">35</span>).carbohydrate(<span class="number">27</span>).build();</div></pre></td></tr></table></figure></p>
<h4 id="Item3-Enforce-the-singleton-property-with-a-private-constructor-or-an-enum-type"><a href="#Item3-Enforce-the-singleton-property-with-a-private-constructor-or-an-enum-type" class="headerlink" title="Item3: Enforce the singleton property with a private constructor or an enum type"></a>Item3: Enforce the singleton property with a private constructor or an enum type</h4><p>singleton class implements:</p>
<ol>
<li><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Singleton with public final field</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Elvis</span> </span>&#123;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Elvis INSTANCE = <span class="keyword">new</span> Elvis();</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Elvis</span><span class="params">()</span> </span>&#123; ... &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">leaveTheBuilding</span><span class="params">()</span> </span>&#123; ... &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<p>2.<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Singleton with static factory</span></div><div class="line">  <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Elvis</span> </span>&#123;</div><div class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Elvis INSTANCE = <span class="keyword">new</span> Elvis();          <span class="function"><span class="keyword">private</span> <span class="title">Elvis</span><span class="params">()</span> </span>&#123; ... &#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Elvis <span class="title">getInstance</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> INSTANCE; &#125;</div><div class="line">     <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">leaveTheBuilding</span><span class="params">()</span> </span>&#123; ... &#125;</div><div class="line"> &#125;</div></pre></td></tr></table></figure></p>
<ol>
<li>best, provides the serializatin machinery for free.<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Enum singleton - the preferred approach</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">enum</span> Elvis &#123;</div><div class="line">    INSTANCE;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">leaveTheBuilding</span><span class="params">()</span> </span>&#123; ... &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="Item4-Enforce-noninstantialibity-with-a-private-constructor"><a href="#Item4-Enforce-noninstantialibity-with-a-private-constructor" class="headerlink" title="Item4: Enforce noninstantialibity with a private constructor"></a>Item4: Enforce noninstantialibity with a private constructor</h4><p>A default construc- tor is generated only if a class contains no explicit constructors, so a class can be made noninstantiable by including a private constructor:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Noninstantiable utility class</span></div><div class="line"> <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UtilityClass</span> </span>&#123;</div><div class="line">     <span class="comment">// Suppress default constructor for noninstantiability</span></div><div class="line">     <span class="function"><span class="keyword">private</span> <span class="title">UtilityClass</span><span class="params">()</span> </span>&#123;</div><div class="line">         <span class="keyword">throw</span> <span class="keyword">new</span> AssertionError();</div><div class="line">  &#125;</div><div class="line">     ...  <span class="comment">// Remainder omitted</span></div><div class="line"> &#125;</div></pre></td></tr></table></figure></p>
<p>It guarantees that the class will never be instantiated under any circumstances. This idiom also prevents the class from being subclassed. All constructors must invoke a superclass constructor, explicitly or implicitly, and a subclass would have no accessible superclass constructor to invoke.</p>
<h4 id="Item5-Avoid-creating-unnecessary-objects"><a href="#Item5-Avoid-creating-unnecessary-objects" class="headerlink" title="Item5: Avoid creating unnecessary objects"></a>Item5: Avoid creating unnecessary objects</h4><p>String s = new String(“stringette”); // DON’T DO THIS!<br>“stringette” is itself a string instance. If this use occurs in a loop or in a frequently invoked method, many string instances will be created needlessly.So just simply<br>String s = “stringette”;<br>This uses a single string instance rather than creating a new one each time.</p>
<h4 id="Item6-Eliminate-obsolete-object-references"><a href="#Item6-Eliminate-obsolete-object-references" class="headerlink" title="Item6: Eliminate obsolete object references"></a>Item6: Eliminate obsolete object references</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">   <span class="comment">// Can you spot the "memory leak"?</span></div><div class="line">   <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Stack</span> </span>&#123;</div><div class="line">       <span class="keyword">private</span> Object[] elements;</div><div class="line">       <span class="keyword">private</span> <span class="keyword">int</span> size = <span class="number">0</span>;</div><div class="line">       <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> DEFAULT_INITIAL_CAPACITY = <span class="number">16</span>;</div><div class="line">       <span class="function"><span class="keyword">public</span> <span class="title">Stack</span><span class="params">()</span> </span>&#123;</div><div class="line">           elements = <span class="keyword">new</span> Object[DEFAULT_INITIAL_CAPACITY];</div><div class="line">&#125;</div><div class="line">       <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">push</span><span class="params">(Object e)</span> </span>&#123;</div><div class="line">           ensureCapacity();</div><div class="line">           elements[size++] = e;</div><div class="line">&#125;</div><div class="line">       <span class="function"><span class="keyword">public</span> Object <span class="title">pop</span><span class="params">()</span> </span>&#123;</div><div class="line">           <span class="keyword">if</span> (size == <span class="number">0</span>)</div><div class="line">               <span class="keyword">throw</span> <span class="keyword">new</span> EmptyStackException();</div><div class="line">           <span class="keyword">return</span> elements[--size];</div><div class="line">&#125;</div><div class="line">       <span class="comment">/**</span></div><div class="line">        * Ensure space for at least one more element, roughly</div><div class="line">        * doubling the capacity each time the array needs to grow.</div><div class="line">        */</div><div class="line">       <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">ensureCapacity</span><span class="params">()</span> </span>&#123;</div><div class="line">           <span class="keyword">if</span> (elements.length == size)</div><div class="line">               elements = Arrays.copyOf(elements, <span class="number">2</span> * size + <span class="number">1</span>);</div><div class="line">&#125; </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>It will have obsolete reference. should be modified as<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">pop</span><span class="params">()</span> </span>&#123;</div><div class="line">       <span class="keyword">if</span> (size == <span class="number">0</span>)</div><div class="line"><span class="keyword">throw</span> <span class="keyword">new</span> EmptyStackException();</div><div class="line">Object result = elements[--size];</div><div class="line">elements[size] = <span class="keyword">null</span>; <span class="comment">// Eliminate obsolete reference return result;</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h4 id="Item7-Avoid-finalizers"><a href="#Item7-Avoid-finalizers" class="headerlink" title="Item7: Avoid finalizers"></a>Item7: Avoid finalizers</h4><p>never do anything time-critical in a finalizer.For example, it is a grave error to depend on a finalizer to close files, because open file descriptors are a limited resource. If many files are left open because the JVM is tardy in execut- ing finalizers, a program may fail because it can no longer open files.<br>never depend on a finalizer to update critical persistent state. For example, depending on a finalizer to release a persistent lock on a shared resource such as a database is a good way to bring your entire distributed system to a grinding halt.<br>Explicit termination methods are typically used in combination with the try-finally construct to ensure termination. Invoking the explicit termination method inside the finally clause ensures that it will get executed even if an exception is thrown while the object is being used<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// try-finally block guarantees execution of termination method</span></div><div class="line"> Foo foo = <span class="keyword">new</span> Foo(...);</div><div class="line"> <span class="keyword">try</span> &#123;</div><div class="line">     <span class="comment">// Do what must be done with foo</span></div><div class="line">     ...</div><div class="line"> &#125; <span class="keyword">finally</span> &#123;</div><div class="line">     foo.terminate();  <span class="comment">// Explicit termination method</span></div><div class="line"> &#125;</div></pre></td></tr></table></figure></p>
<h2 id="Chapter-3-Methods-Common-to-All-Objects"><a href="#Chapter-3-Methods-Common-to-All-Objects" class="headerlink" title="Chapter 3 - Methods Common to All Objects"></a>Chapter 3 - Methods Common to All Objects</h2><p>####Item 8: Obey the general contract when overriding equals<br>when is it appropriate to override Object.equals?<br>When a class has a notion of logical equality that differs from mere object identity, and a superclass has not already overridden equals to implement the desired behavior.<br>One kind of value class that does not require the equals method to be overridden is a class that uses instance control to ensure that at most one object exists with each value. e.g. Enum types  For these classes, logical equality is the same as object identity, so Object’s equals method functions as a logical equals method.<br>For any non-nullreference </p>
<blockquote>
<ul>
<li>reflexive: x.equals(x) ==true.</li>
<li>symmetric: x.equals(y) == true and y.equals(z)  == true, then x.equals(z) must be true</li>
<li>consistent: x.equals(y) consistently return true or flase</li>
<li>x.equals(null) must return false</li>
</ul>
</blockquote>
<p>There is no way to extend an instantiable class and add a value component while preserving the equals contract, unless you are willing to forgo the benefits of object-oriented abstraction.<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">   <span class="comment">// Adds a value component without violating the equals contract</span></div><div class="line">   <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ColorPoint</span> </span>&#123;</div><div class="line">      <span class="keyword">private</span> <span class="keyword">final</span> Point point;</div><div class="line">      <span class="keyword">private</span> <span class="keyword">final</span> Color color;</div><div class="line">      <span class="function"><span class="keyword">public</span> <span class="title">ColorPoint</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, Color color)</span> </span>&#123;</div><div class="line">         <span class="keyword">if</span> (color == <span class="keyword">null</span>)</div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException();</div><div class="line">         point = <span class="keyword">new</span> Point(x, y);</div><div class="line">         <span class="keyword">this</span>.color = color;</div><div class="line">&#125;</div><div class="line">      <span class="comment">/**</span></div><div class="line">       * Returns the point-view of this color point.</div><div class="line">       */</div><div class="line">    <span class="function"><span class="keyword">public</span> Point <span class="title">asPoint</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> point;</div><div class="line">&#125;</div><div class="line">      <span class="meta">@Override</span> <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object o)</span> </span>&#123;</div><div class="line">         <span class="keyword">if</span> (!(o <span class="keyword">instanceof</span> ColorPoint))</div><div class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">         ColorPoint cp = (ColorPoint) o;</div><div class="line">         <span class="keyword">return</span> cp.point.equals(point) &amp;&amp; cp.color.equals(color);</div><div class="line">&#125;</div><div class="line">      ...  <span class="comment">// Remainder omitted</span></div><div class="line">   &#125;</div></pre></td></tr></table></figure></p>
<p>don’t have to do a separate check for null such as<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">  <span class="meta">@Override</span> <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object o)</span> </span>&#123;</div><div class="line">              <span class="keyword">if</span> (o == <span class="keyword">null</span>)</div><div class="line">                  <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">              ...</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Because: the instanceof operator is specified to return false if its first operand is null, regardless of what type appears in the second operand. Therefore the type check will return false if null is passed in, so you don’t need a separate null check.<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Override</span> <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object o)</span> </span>&#123;</div><div class="line">             <span class="keyword">if</span> (!(o <span class="keyword">instanceof</span> MyType))</div><div class="line">                 <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">             MyType mt = (MyType) o;</div><div class="line">             ...</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Putting it all together:</p>
<blockquote>
<ul>
<li>1.Use the == operator to check if the argument is a reference to this object.</li>
<li>2.Use the instanceof operator to check if the argument has the correct type.</li>
<li><ol>
<li>Cast the argument to the correct type. This cast is preceded by an instanceof test.</li>
</ol>
</li>
<li><ol>
<li>For each “significant” field in the class, check if that field of the argument matches the corresponding field of this object.</li>
</ol>
</li>
</ul>
</blockquote>
<p>For primitive fields whose type is not float or double, use the == operator for comparisons;<br>for object reference fields, invoke the equals method recursively;<br>for float fields, use the Float.compare method;<br>and for double fields, use Double.compare<br>Some object reference fields may legitimately contain null. To avoid the pos- sibility of a NullPointerException, use this idiom to compare such fields:<br>(field == null ? o.field == null : field.equals(o.field)) This alternative may be faster if field and o.field are often identical:<br>(field == o.field || (field != null &amp;&amp; field.equals(o.field)))<br>Don’t substitute another type for Object in the equals declaration.<br>Consistent use of the @Override annotation</p>
<h3 id="Item-9-Always-override-hashCode-when-you-override-equals"><a href="#Item-9-Always-override-hashCode-when-you-override-equals" class="headerlink" title="#Item 9: Always override hashCode when you override equals"></a>#Item 9: Always override hashCode when you override equals</h3><p>You must override hashCode in every class that overrides equals. Failure to do so will result in a violation of the general contract for Object.hashCode, which will prevent your class from functioning properly in conjunction with all hash-based collections, including HashMap, HashSet, and Hashtable.<br>result = 31 <em> result + c;<br>A nonzero initial value is used in step 1 so the hash value will be affected by initial fields whose hash value<br>A nice property of 31 is that the multiplication can be replaced by a shift and a subtraction for better performance: 31 </em> i == (i &lt;&lt; 5) - i. Modern VMs do this sort of optimization automatically.<br>example:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">       <span class="meta">@Override</span> </div><div class="line">       <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>&#123;</div><div class="line">           <span class="keyword">int</span> result = <span class="number">17</span>;</div><div class="line">           result = <span class="number">31</span> * result + areaCode;</div><div class="line">           result = <span class="number">31</span> * result + prefix;</div><div class="line">           result = <span class="number">31</span> * result + lineNumber;</div><div class="line">           <span class="keyword">return</span> result;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h4 id="Item10-Always-override-toString"><a href="#Item10-Always-override-toString" class="headerlink" title="Item10: Always override toString"></a>Item10: Always override toString</h4><p>While it isn’t as important as obeying the equals and hashCode contracts (Item 8, Item 9), providing a good toString implementation makes your class much more pleasant to use.</p>
<h4 id="Item11-Override-clone-judiciously"><a href="#Item11-Override-clone-judiciously" class="headerlink" title="Item11: Override clone judiciously"></a>Item11: Override clone judiciously</h4><p> x.clone().equals(x)</p>
<p>the clone method functions as another constructor; you must ensure that it does no harm to the original object and that it prop- erly establishes invariants on the clone.<br>reference issues in below if use super.clone()<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Stack</span> </span>&#123;</div><div class="line">       <span class="keyword">private</span> Object[] elements;</div><div class="line">       <span class="keyword">private</span> <span class="keyword">int</span> size = <span class="number">0</span>;</div><div class="line">       <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> DEFAULT_INITIAL_CAPACITY = <span class="number">16</span>;</div><div class="line">       <span class="function"><span class="keyword">public</span> <span class="title">Stack</span><span class="params">()</span> </span>&#123;</div><div class="line">           <span class="keyword">this</span>.elements = <span class="keyword">new</span> Object[DEFAULT_INITIAL_CAPACITY];</div><div class="line">&#125;</div><div class="line">       <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">push</span><span class="params">(Object e)</span> </span>&#123;</div><div class="line">           ensureCapacity();</div><div class="line">           elements[size++] = e;</div><div class="line">&#125;</div><div class="line">       <span class="function"><span class="keyword">public</span> Object <span class="title">pop</span><span class="params">()</span> </span>&#123;</div><div class="line">           <span class="keyword">if</span> (size == <span class="number">0</span>)</div><div class="line">               <span class="keyword">throw</span> <span class="keyword">new</span> EmptyStackException();</div><div class="line">           Object result = elements[--size];</div><div class="line">           elements[size] = <span class="keyword">null</span>; <span class="comment">// Eliminate obsolete reference</span></div><div class="line">           <span class="keyword">return</span> result;</div><div class="line">&#125;</div><div class="line">       <span class="comment">// Ensure space for at least one more element.</span></div><div class="line">       <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">ensureCapacity</span><span class="params">()</span> </span>&#123;</div><div class="line">           <span class="keyword">if</span> (elements.length == size)</div><div class="line">               elements = Arrays.copyOf(elements, <span class="number">2</span> * size + <span class="number">1</span>);</div><div class="line">    &#125; </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Should use<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"> <span class="meta">@Override</span> <span class="function"><span class="keyword">public</span> Stack <span class="title">clone</span><span class="params">()</span> </span>&#123;</div><div class="line">       <span class="keyword">try</span> &#123;</div><div class="line">           Stack result = (Stack) <span class="keyword">super</span>.clone();</div><div class="line">           result.elements = elements.clone();</div><div class="line">           <span class="keyword">return</span> result;</div><div class="line">       &#125; <span class="keyword">catch</span> (CloneNotSupportedException e) &#123;</div><div class="line">           <span class="keyword">throw</span> <span class="keyword">new</span> AssertionError();</div><div class="line">    &#125; </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>the clone architecture is incompatible with normal use of final fields referring to mutable objects<br>for hashtable<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HashTable</span> <span class="keyword">implements</span> <span class="title">Cloneable</span> </span>&#123;</div><div class="line">       <span class="keyword">private</span> Entry[] buckets = ...;</div><div class="line">       <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Entry</span> </span>&#123;</div><div class="line">           <span class="keyword">final</span> Object key;</div><div class="line">           Object value;</div><div class="line">           Entry  next;</div><div class="line">           Entry(Object key, Object value, Entry next) &#123;</div><div class="line">               <span class="keyword">this</span>.key   = key;</div><div class="line">               <span class="keyword">this</span>.value = value;</div><div class="line">               <span class="keyword">this</span>.next  = next;</div><div class="line">&#125;</div><div class="line"><span class="comment">// Recursively copy the linked list headed by this Entry</span></div><div class="line">           <span class="function">Entry <span class="title">deepCopy</span><span class="params">()</span> </span>&#123;</div><div class="line">               <span class="keyword">return</span> <span class="keyword">new</span> Entry(key, value,</div><div class="line">                   next == <span class="keyword">null</span> ? <span class="keyword">null</span> : next.deepCopy());</div><div class="line">    &#125; </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>If the list is long, this could easily cause a stack overflow. To prevent this from happening, you can replace the recursion in deepCopy with iteration:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Iteratively copy the linked list headed by this Entry</span></div><div class="line">   <span class="function">Entry <span class="title">deepCopy</span><span class="params">()</span> </span>&#123;</div><div class="line">      Entry result = <span class="keyword">new</span> Entry(key, value, next);</div><div class="line">      <span class="keyword">for</span> (Entry p = result; p.next != <span class="keyword">null</span>; p = p.next)</div><div class="line">      p.next = <span class="keyword">new</span> Entry(p.next.key, p.next.value,    p.next.next);</div><div class="line">      <span class="keyword">return</span> result;</div><div class="line">   &#125;</div></pre></td></tr></table></figure></p>
<p>Furthermore, a copy constructor or factory can take an argument whose type is an interface implemented by the class. For example, by convention all general- purpose collection implementations provide a constructor whose argument is of type Collection or Map. Interface-based copy constructors and factories, more properly known as <code>conversion constructors</code> and <code>conversion factories</code>, allow the client to choose the implementation type of the copy rather than forcing the client to accept the implementation type of the original. Suppose you have a HashSet s, and you want to copy it as a TreeSet. The clone method can’t offer this function- ality, but it’s easy with a conversion constructor: new TreeSet(s).</p>
<h4 id="Item12-ConsiderimplementingComparable"><a href="#Item12-ConsiderimplementingComparable" class="headerlink" title="Item12: ConsiderimplementingComparable"></a>Item12: ConsiderimplementingComparable</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compareTo</span><span class="params">(PhoneNumber pn)</span> </span>&#123;</div><div class="line">    <span class="comment">// Compare area codes</span></div><div class="line">    <span class="keyword">int</span> areaCodeDiff = areaCode - pn.areaCode;</div><div class="line">    <span class="keyword">if</span> (areaCodeDiff != <span class="number">0</span>)</div><div class="line">        <span class="keyword">return</span> areaCodeDiff;</div><div class="line">    <span class="comment">// Area codes are equal, compare prefixes</span></div><div class="line">    <span class="keyword">int</span> prefixDiff = prefix - pn.prefix;</div><div class="line">    <span class="keyword">if</span> (prefixDiff != <span class="number">0</span>)</div><div class="line">        <span class="keyword">return</span> prefixDiff;</div><div class="line">    <span class="comment">// Area codes and prefixes are equal, compare line numbers</span></div><div class="line">    <span class="keyword">return</span> lineNumber - pn.lineNumber;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Chapter-4"><a href="#Chapter-4" class="headerlink" title="Chapter 4 -"></a>Chapter 4 -</h2>
        
      </div>
    </div>

  

  
  
    
  

    <div class="post-list-item article">
      <h3 class="article-header">
        <a href="/2017/02/05/Java-Read-and-Write-files/" >
  Java Read and Write files
</a>

      </h3>
      

      <div class="article-info">
        <a href="/2017/02/05/Java-Read-and-Write-files/"><span class="article-date">
  2017-02-05
</span>
</a>
        

        
	<span class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java-Programming/">Java Programming</a></li></ul>
	</span>


      </div>
      <div class="article-entry">
        
          <p>It’s pretty forgettable about the I/O in Java.<br>For now list some common ways for reminder. TODO: go over the book.<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*reading a file by using stream I/O*/</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span></span>&#123;</div><div class="line">	String filePath = <span class="string">"..."</span>;</div><div class="line">	<span class="keyword">try</span>&#123;</div><div class="line">	<span class="comment">/*read the input text file*/</span></div><div class="line">	File file = <span class="keyword">new</span> File(filePath);</div><div class="line">	<span class="comment">/*build a input stream reader*/</span></div><div class="line">	InputStreamReader reader = <span class="keyword">new</span> InputStreamReader(<span class="keyword">new</span> FileInputStream(file));</div><div class="line">	BufferedReader br = <span class="keyword">new</span> BufferedReader(reader);</div><div class="line">	String line = <span class="string">""</span>;</div><div class="line">	line = br.readLine();</div><div class="line">	<span class="comment">/*read by line*/</span></div><div class="line">		<span class="keyword">while</span>(line != <span class="keyword">null</span>)&#123;</div><div class="line">			line = br.readLine();</div><div class="line">		&#125;</div><div class="line"></div><div class="line"></div><div class="line">		<span class="comment">/*write text file*/</span></div><div class="line">	File writename = <span class="keyword">new</span> File(<span class="string">".\\result\\en\\output.txt"</span>); <span class="comment">//build a file if not already exits</span></div><div class="line">        writename.createNewFile(); <span class="comment">// create new file </span></div><div class="line">        BufferedWriter out = <span class="keyword">new</span> BufferedWriter(<span class="keyword">new</span> FileWriter(writename));  </div><div class="line">         </div><div class="line">        out.write(<span class="string">"i AM WRITING OUT\r\n"</span>); <span class="comment">// \r\n </span></div><div class="line">        out.flush(); <span class="comment">// put the buffered content into the file</span></div><div class="line">        out.close(); <span class="comment">// close the file at the end</span></div><div class="line">  </div><div class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;  </div><div class="line">            e.printStackTrace();  </div><div class="line">        &#125;  </div><div class="line"></div><div class="line">	&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Reference:<br><a href="http://blog.csdn.net/monkeyduck/article/details/11525771" target="_blank" rel="external">http://blog.csdn.net/monkeyduck/article/details/11525771</a><br><a href="http://www.cnblogs.com/0201zcr/p/5009975.html" target="_blank" rel="external">http://www.cnblogs.com/0201zcr/p/5009975.html</a><br><a href="http://blog.csdn.net/makeitperfect/article/details/9094613" target="_blank" rel="external">http://blog.csdn.net/makeitperfect/article/details/9094613</a></p>

        
      </div>
    </div>

  

  
  
    
  

    <div class="post-list-item article">
      <h3 class="article-header">
        <a href="/2017/02/04/JSON-used-in-Java/" >
  JSON used in Java
</a>

      </h3>
      

      <div class="article-info">
        <a href="/2017/02/04/JSON-used-in-Java/"><span class="article-date">
  2017-02-04
</span>
</a>
        

        
	<span class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java-Programming/">Java Programming</a></li></ul>
	</span>


      </div>
      <div class="article-entry">
        
          <p>download <a href="http://www.java2s.com/Code/Jar/j/Downloadjsonsimple111jar.htm" target="_blank" rel="external">jason-simple-1.1.1. jar</a><br>To deploy the Java library in Eclipse.<br>right click project - build path - add external archives - choose the jar to import.<br>JSON object is like java.util.Map<br>JSON array is like java.util.List</p>
<p>A JSON object is an unordered set of key/value pairs.<br>A JSON array is an ordered collection of values. The values could be objects or arrays.</p>
<p>Build an object form String, and retrieves by providing keys.</p>
<script src="https://gist.github.com/monabest/f802735258f8f4a22a5e2c5a3f30e1bb.js"></script>

<p>Will show as {“balance”: 1000.21, “num”:100, “is_vip”:true, “name”:”foo”}</p>
<p>Reference:<br><a href="http://theoryapp.com/parse-json-in-java/" target="_blank" rel="external">http://theoryapp.com/parse-json-in-java/</a><br><a href="https://examples.javacodegeeks.com/core-java/json/java-json-parser-example/" target="_blank" rel="external">https://examples.javacodegeeks.com/core-java/json/java-json-parser-example/</a><br><a href="http://wiki.jikexueyuan.com/project/json/with-java.html" target="_blank" rel="external">http://wiki.jikexueyuan.com/project/json/with-java.html</a></p>

        
      </div>
    </div>

  






          <div class="main-footer">
  
    © 2017 MonaBest-Blogggyyy - Powered by <a href="http://hexo.io" target="_blank">Hexo</a> - Theme <a href="https://github.com/denjones/hexo-theme-chan" target="_blank">Chan</a>
  
</div>

      
        </div>
      
    </div>
  </div>
  <script src="http://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>

  <link rel="stylesheet" href="/PhotoSwipe/photoswipe.css">
  <link rel="stylesheet" href="/PhotoSwipe/default-skin/default-skin.css">

  <!-- Root element of PhotoSwipe. Must have class pswp. -->
  <div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe.
             It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

      <!-- Container that holds slides.
                PhotoSwipe keeps only 3 of them in the DOM to save memory.
                Don't modify these 3 pswp__item elements, data is added later on. -->
      <div class="pswp__container">
        <div class="pswp__item"></div>
        <div class="pswp__item"></div>
        <div class="pswp__item"></div>
      </div>

      <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
      <div class="pswp__ui pswp__ui--hidden">

        <div class="pswp__top-bar">

          <!--  Controls are self-explanatory. Order can be changed. -->

          <div class="pswp__counter"></div>

          <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

          <button class="pswp__button pswp__button--share" title="Share"></button>

          <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

          <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

          <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
          <!-- element will get class pswp__preloader--active when preloader is running -->
          <div class="pswp__preloader">
            <div class="pswp__preloader__icn">
              <div class="pswp__preloader__cut">
                <div class="pswp__preloader__donut"></div>
              </div>
            </div>
          </div>
        </div>

        <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
          <div class="pswp__share-tooltip"></div>
        </div>

        <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>

        <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button>

        <div class="pswp__caption">
          <div class="pswp__caption__center"></div>
        </div>
      </div>
    </div>
  </div>

  <script src="/PhotoSwipe/photoswipe.js"></script>
  <script src="/PhotoSwipe/photoswipe-ui-default.js"></script>


<script src="/scripts/main.js"></script>

</body>
</html>
